# vim:set et sw=2 ts=8 ft=zsh:

local cmd="command mdfind kind:folder -onlyin . 2>/dev/null"
setopt localoptions pipefail 2> /dev/null
local dir="$(eval "$cmd" | fzf-tmux +m --reverse --height 40%)"
if [[ -z "$dir" ]]; then
  zle redisplay
  return 0
fi
cd "$dir"
local ret=$?

local precmd
for precmd in $precmd_functions; do
  $precmd
done
zle reset-prompt
typeset -f zle-line-init >/dev/null && zle zle-line-init
return $ret
